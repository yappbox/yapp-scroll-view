{"version":3,"file":"scroll-view.js","sources":["../../src/components/scroll-view.js"],"sourcesContent":["import Component from '@glimmer/component';\nimport { tracked } from '@glimmer/tracking';\nimport { action } from '@ember/object';\nimport { inject as service } from '@ember/service';\nimport normalizeWheel from '../utils/normalize-wheel.js';\nimport Hammer from 'hammerjs';\nimport ZyngaScrollerVerticalRecognizer from '../utils/zynga-scroller-vertical-recognizer.js';\nimport { join, schedule } from '@ember/runloop';\nimport { translate } from '../utils/translate.js';\nimport { task, timeout, waitForQueue } from 'ember-concurrency';\nimport ScrollViewApi from '../utils/scroll-view-api.js';\nimport { buildWaiter } from '@ember/test-waiters';\nimport { isTesting } from '@embroider/macros';\nimport { cached } from '@glimmer/tracking';\nimport Scroller from '../vendor/zynga-scroller.js';\n\nlet waiter = buildWaiter('yapp-scroll-view:scrolling');\nlet measurementWaiter = buildWaiter('yapp-scroll-view:measurement');\n\nconst FIELD_REGEXP = /input|textarea|select/i;\nconst MEASUREMENT_INTERVAL = 250;\nconst MEASUREMENT_INTERVAL_WHILE_SCROLLING_OR_OFFSCREEN = 1000;\nconst LONG_PRESS_DELAY = 500;\nconst GHOST_CLICK_DELAY = 100;\n\nconst isIPhone = /iPhone|iPod|iPad/i.test(navigator.appVersion);\n\nlet timeoutID = 0;\nfunction addCaptureClick(domElement) {\n  if (timeoutID) {\n    clearTimeout(timeoutID);\n  } else {\n    domElement.addEventListener('click', captureClick, true);\n  }\n  let cancelCaptureClick = () => {\n    timeoutID = 0;\n    domElement.removeEventListener('click', captureClick, true);\n  };\n  timeoutID = setTimeout(cancelCaptureClick, GHOST_CLICK_DELAY);\n}\n\nfunction debounce(func, wait, immediate) {\n  var timeout;\n  return function () {\n    var context = this,\n      args = arguments;\n    var later = function () {\n      timeout = null;\n      if (!immediate) func.apply(context, args);\n    };\n    var callNow = immediate && !timeout;\n    clearTimeout(timeout);\n    timeout = setTimeout(later, wait);\n    if (callNow) func.apply(context, args);\n  };\n}\n\nfunction getScrolledToTopChanged(currentTop, lastTop, offset) {\n  let isAtTop = currentTop <= offset;\n  let isAtTopChanged = false;\n  if (isAtTop && (lastTop > offset || lastTop === undefined)) {\n    isAtTopChanged = true;\n  } else if (!isAtTop && (lastTop <= offset || lastTop === undefined)) {\n    isAtTopChanged = true;\n  }\n\n  return { isAtTop, isAtTopChanged };\n}\n\nfunction captureClick(e) {\n  e.stopPropagation();\n  e.target\n    .closest('.ScrollView')\n    .removeEventListener('click', captureClick, true);\n}\n\nclass ScrollView extends Component {\n  _scrollTop = 0;\n  _isAtTop;\n  _needsContentSizeUpdate = true;\n  _appliedClientWidth;\n  _appliedClientHeight;\n  _appliedContentHeight;\n  @tracked scrollBarClientHeight;\n  @tracked scrollBarContentHeight;\n  _appliedScrollTop;\n  _shouldMeasureContent = undefined;\n  _isScrolling = false;\n  _touchStartTimeStamp = null;\n  _lastIsScrolling = false;\n  _touchStartDecelerationVelocityY = 0;\n  _touchStartWasDecelerating = false;\n  _touchStartWasDragging = false;\n  _preventClickWhileDecelerating = false;\n  _measurementWaiterToken = null;\n\n  @service('scroll-position-memory')\n  memory;\n\n  constructor() {\n    super(...arguments);\n    this._scrollPositionCallbacks = [];\n    this.debouncedOnScrollingComplete = debounce(this.onScrollingComplete, 500);\n  }\n\n  @action\n  onContentHeightChanged() {\n    if (this._shouldMeasureContent === undefined) {\n      this._shouldMeasureContent = !this.args.contentHeight;\n    }\n\n    if (\n      !this._shouldMeasureContent &&\n      this._appliedContentHeight !== this.args.contentHeight\n    ) {\n      this.measureClientAndContent();\n    }\n  }\n\n  @action\n  didInsert(element) {\n    this.scrollViewElement = element;\n    this.contentElement = element.firstElementChild;\n    this.setupScroller();\n    this.measurementTask.perform();\n    this.bindScrollerEvents(element);\n    this.onKeyUpdated();\n  }\n\n  @action\n  onKeyUpdated() {\n    let { _lastKey } = this;\n    let { key } = this.args;\n    if (key !== _lastKey) {\n      if (_lastKey) {\n        this.remember(_lastKey);\n      }\n      if (key) {\n        this.restore(key);\n      }\n      this._lastKey = key;\n    }\n  }\n\n  willDestroy() {\n    this.unbindScrollerEvents(this.scrollViewElement);\n    this.scrollViewElement = null;\n    this._scrollPositionCallbacks = [];\n    this.remember(this._lastKey);\n    {\n      if (isTesting()) {\n        window.SIMULATE_SCROLL_VIEW_MEASUREMENT_LOOP = null;\n      }\n      this._trackIsScrollingForWaiter(false);\n    }\n    super.willDestroy(...arguments);\n  }\n\n  setupScroller() {\n    this.scroller = new Scroller(this.onScrollChange.bind(this), {\n      scrollingX: false,\n      scrollingComplete: this.onScrollingComplete.bind(this),\n    });\n  }\n\n  onScrollChange(_left, top) {\n    let scrollTop = top | 0;\n    if (this.isDestroyed || this.isDestroying) {\n      return;\n    }\n    let { scroller } = this;\n    let isScrolling = !!(\n      scroller.__isDragging ||\n      scroller.__isDecelerating ||\n      scroller.__isAnimating\n    );\n    this._isScrolling = isScrolling;\n    this._decelerationVelocityY = scroller.__decelerationVelocityY;\n    this.applyScrollTop({\n      scrollTop,\n      lastTop: this._appliedScrollTop,\n      isScrolling,\n      decelerationVelocityY: this._decelerationVelocityY,\n    });\n    if (\n      +new Date() - this._lastMeasurement >\n      MEASUREMENT_INTERVAL_WHILE_SCROLLING_OR_OFFSCREEN\n    ) {\n      this.measureClientAndContent();\n    }\n\n    this.debouncedOnScrollingComplete();\n  }\n\n  applyScrollTop({ scrollTop, lastTop, isScrolling, decelerationVelocityY }) {\n    let { isAtTop, isAtTopChanged } = getScrolledToTopChanged(\n      scrollTop,\n      lastTop,\n      this.scrollTopOffset,\n    );\n\n    if (this.contentElement) {\n      translate(this.contentElement, 0, -1 * scrollTop);\n    }\n\n    this.notifyScrollPosition(\n      isScrolling,\n      scrollTop,\n      isAtTop,\n      decelerationVelocityY,\n    );\n\n    if (this.scroller?.__isDecelerating) {\n      this._preventClickWhileDecelerating = true;\n    }\n\n    if (this.args.scrollChange && scrollTop !== lastTop) {\n      this.args.scrollChange(scrollTop);\n    }\n    if (this.args.scrolledToTopChange && isAtTopChanged) {\n      this.args.scrolledToTopChange(isAtTop);\n    }\n    this._appliedScrollTop = scrollTop;\n    {\n      this._trackIsScrollingForWaiter(isScrolling);\n    }\n  }\n\n  onScrollingComplete() {\n    if (this.isDestroyed || this.isDestroying) {\n      return;\n    }\n    this.notifyScrollPosition(\n      false,\n      this._appliedScrollTop,\n      this._appliedScrollTop <= this.scrollTopOffset,\n      0,\n    );\n    this._preventClickWhileDecelerating = false;\n    {\n      this._trackIsScrollingForWaiter(false);\n    }\n  }\n\n  updateScrollerDimensions() {\n    if (this._appliedClientWidth && this._appliedClientHeight) {\n      this.scroller.setDimensions(\n        this._appliedClientWidth,\n        this._appliedClientHeight,\n        this._appliedClientWidth,\n        this._appliedContentHeight,\n      );\n    }\n  }\n\n  bindScrollerEvents(element) {\n    this.hammer = new Hammer.Manager(element, {\n      inputClass: Hammer.TouchMouseInput,\n      recognizers: [\n        [ZyngaScrollerVerticalRecognizer, { scrollComponent: this }],\n      ],\n    });\n    this._boundHandleWheel = this.handleWheel.bind(this);\n    element.addEventListener(\n      normalizeWheel.getEventType(),\n      this._boundHandleWheel,\n      { passive: false },\n    );\n    this._scrollViewDocument = element.ownerDocument;\n    this._boundHandleCapturedClick = (event) => {\n      if (!this.scrollViewElement?.contains(event.target)) {\n        return;\n      }\n      this.handleCapturedClickDuringMomentum(event);\n    };\n    this._scrollViewDocument.addEventListener(\n      'click',\n      this._boundHandleCapturedClick,\n      true,\n    );\n  }\n\n  unbindScrollerEvents(element) {\n    if (this.hammer) {\n      this.hammer.destroy();\n      this.hammer = null;\n    }\n    element?.removeEventListener(\n      normalizeWheel.getEventType(),\n      this._boundHandleWheel,\n      false,\n    );\n    this._scrollViewDocument?.removeEventListener(\n      'click',\n      this._boundHandleCapturedClick,\n      true,\n    );\n    this._scrollViewDocument = null;\n  }\n\n  doTouchStart(touches, timeStamp) {\n    let { scroller } = this;\n    this._touchStartWasDragging = !!scroller?.__isDragging;\n    this._touchStartWasDecelerating = !!(\n      scroller?.__isDecelerating || scroller?.__isAnimating\n    );\n    this._touchStartDecelerationVelocityY =\n      scroller?.__decelerationVelocityY ?? this._decelerationVelocityY ?? 0;\n    this._wasScrollingAtTouchStart =\n      this._isScrolling ||\n      this._touchStartWasDragging ||\n      this._touchStartWasDecelerating;\n    this._touchStartTimeStamp = timeStamp;\n    this.scroller.doTouchStart(touches, timeStamp);\n  }\n\n  doTouchMove(touches, timeStamp, scale) {\n    this.scroller.doTouchMove(touches, timeStamp, scale);\n  }\n\n  doTouchEnd(_touches, timeStamp, event) {\n    let touchDuration = this._touchStartTimeStamp\n      ? timeStamp - this._touchStartTimeStamp\n      : 0;\n    let preventClick = this.needsPreventClick(touchDuration);\n\n    if (preventClick) {\n      if (isIPhone || event instanceof MouseEvent) {\n        addCaptureClick(this.scrollViewElement);\n      }\n      event.preventDefault();\n      event.stopPropagation();\n      this._preventClickWhileDecelerating = true;\n    }\n\n    this._touchStartTimeStamp = null;\n    this.scroller.doTouchEnd(timeStamp);\n    this._touchStartWasDragging = false;\n    this._touchStartWasDecelerating = false;\n    this._touchStartDecelerationVelocityY = 0;\n  }\n\n  needsPreventClick(touchDuration) {\n    let momentumVelocity =\n      this._touchStartDecelerationVelocityY ?? this._decelerationVelocityY ?? 0;\n    let isFinishingDragging =\n      this._touchStartWasDragging || this.scroller.__isDragging;\n    let wasAnimatingWithMomentum =\n      this._touchStartWasDecelerating ||\n      (this._wasScrollingAtTouchStart && Math.abs(momentumVelocity) > 0.5);\n    let isLongPress = touchDuration > LONG_PRESS_DELAY;\n    return isFinishingDragging || wasAnimatingWithMomentum || isLongPress;\n  }\n\n  handleWheel(e) {\n    if (e.target && e.target.tagName.match(FIELD_REGEXP)) {\n      return;\n    }\n    let eventInfo = normalizeWheel(e);\n    let delta = eventInfo.pixelY;\n    let { scroller } = this;\n    let scrollTop = scroller.__scrollTop;\n    let maxScrollTop = scroller.__maxScrollTop;\n    let candidatePosition = scrollTop + delta;\n\n    e.preventDefault();\n    if (\n      (scrollTop === 0 && candidatePosition < 0) ||\n      (scrollTop === maxScrollTop && candidatePosition > maxScrollTop)\n    ) {\n      return;\n    }\n    scroller.scrollBy(0, delta, true);\n    e.stopPropagation();\n  }\n\n  handleCapturedClickDuringMomentum(event) {\n    if (!this.shouldBlockMomentumClick()) {\n      return;\n    }\n    let target = event.target;\n    if (!target?.closest('a')) {\n      return;\n    }\n    event.preventDefault();\n    event.stopPropagation();\n    event.stopImmediatePropagation();\n    this._preventClickWhileDecelerating = false;\n  }\n\n  shouldBlockMomentumClick() {\n    return this._preventClickWhileDecelerating;\n  }\n\n  measurementTask = task(async () => {\n    let initialScrollTop =\n      this.args.initialScrollTop !== undefined\n        ? this.args.initialScrollTop\n        : this.scrollTopOffset;\n    this._shouldMeasureContent = !this.args.contentHeight;\n    this.measureClientAndContent();\n    this._initialSizeCheckCompleted = true;\n    if (initialScrollTop) {\n      this.scroller.scrollTo(0, initialScrollTop);\n    }\n    {\n      if (isTesting()) {\n        window.SIMULATE_SCROLL_VIEW_MEASUREMENT_LOOP = () => {\n          this.measureClientAndContent();\n        };\n        return;\n      }\n    }\n    let lastIsInViewport = true;\n    // eslint-disable-next-line no-constant-condition\n    while (true) {\n      await timeout(\n        lastIsInViewport\n          ? MEASUREMENT_INTERVAL\n          : MEASUREMENT_INTERVAL_WHILE_SCROLLING_OR_OFFSCREEN,\n      );\n      lastIsInViewport = this.isInViewport;\n      if (lastIsInViewport && !this._isScrolling) {\n        this.measureClientAndContent();\n      }\n    }\n  });\n\n  measureClientAndContent() {\n    this._beginMeasurementWaiter();\n    try {\n      if (!this.scrollViewElement) {\n        return;\n      }\n      this._lastMeasurement = +new Date();\n      let { clientWidth, clientHeight, contentHeight } =\n        this.getCurrentClientAndContentSizes();\n\n      if (\n        !this.hasClientOrContentSizeChanged(\n          clientWidth,\n          clientHeight,\n          contentHeight,\n        )\n      ) {\n        return;\n      }\n      join(\n        this,\n        this.applyNewMeasurements,\n        clientWidth,\n        clientHeight,\n        contentHeight,\n      );\n    } finally {\n      this._endMeasurementWaiter();\n    }\n  }\n\n  getCurrentClientAndContentSizes() {\n    let {\n      scrollViewElement: { offsetWidth, offsetHeight },\n    } = this;\n    let contentHeight = this.args.contentHeight;\n    if (this._shouldMeasureContent && !this.args.isLoadingMore) {\n      contentHeight = this.contentElement.offsetHeight;\n    }\n\n    return {\n      contentHeight,\n      clientHeight: offsetHeight,\n      clientWidth: offsetWidth,\n    };\n  }\n\n  hasClientOrContentSizeChanged(clientWidth, clientHeight, contentHeight) {\n    return (\n      contentHeight !== this._appliedContentHeight ||\n      clientWidth !== this._appliedClientWidth ||\n      clientHeight !== this._appliedClientHeight\n    );\n  }\n\n  applyNewMeasurements(clientWidth, clientHeight, contentHeight) {\n    this._appliedClientWidth = clientWidth;\n    this._appliedClientHeight = clientHeight;\n    this._appliedContentHeight = contentHeight;\n    this.contentElement.style.minHeight = `${clientHeight}px`;\n    this.updateScrollBarDimensionsTask.perform();\n    this.updateScrollerDimensions();\n    if (this.args.clientSizeChange) {\n      this.args.clientSizeChange(clientWidth, clientHeight);\n    }\n  }\n  updateScrollBarDimensionsTask = task(async () => {\n    await waitForQueue('afterRender');\n    this.scrollBarClientHeight = this._appliedClientHeight;\n    this.scrollBarContentHeight = this._appliedContentHeight;\n  });\n\n  get extraCssClasses() {\n    return null;\n  }\n\n  get windowRef() {\n    return window;\n  }\n\n  get scrollTopOffset() {\n    return this.args.scrollTopOffset || 0;\n  }\n\n  get isInViewport() {\n    if (!this.scrollViewElement) {\n      return false;\n    }\n    let rect = this.scrollViewElement.getBoundingClientRect();\n    return (\n      rect.top >= 0 &&\n      rect.left >= 0 &&\n      rect.bottom <=\n        (window.innerHeight || document.documentElement.clientHeight) &&\n      rect.right <= (window.innerWidth || document.documentElement.clientWidth)\n    );\n  }\n\n  scrollTo(yPos, animated = false) {\n    if (this.scrollViewElement) {\n      this.measureClientAndContent();\n      return this.scroller.scrollTo(0, yPos, animated);\n    }\n  }\n\n  scrollToTop() {\n    return this.scrollTo(0, true);\n  }\n\n  scrollToTopIfInViewport() {\n    if (this.isInViewport) {\n      this.scrollToTop();\n    }\n  }\n\n  scrollToBottom() {\n    return this.scrollTo(\n      this._appliedContentHeight - this._appliedClientHeight,\n      true,\n    );\n  }\n\n  scrollToElement(el, animated = false) {\n    this.measureClientAndContent();\n    if (this.scrollViewElement) {\n      let yPos = this._yOffset(el);\n      return this.scroller.scrollTo(0, yPos, animated);\n    } else {\n      return console.warn('scrollToElement called before scrollView is inDOM');\n    }\n  }\n\n  _yOffset(el) {\n    let top = el.offsetTop;\n    while (el !== this.scrollViewElement && (el = el.offsetParent)) {\n      top += el.offsetTop;\n    }\n    return top;\n  }\n\n  getViewHeight() {}\n\n  remember(key) {\n    if (key) {\n      let position = this._appliedScrollTop;\n      this.memory[key] = position;\n    }\n  }\n\n  restore(key) {\n    let position =\n      this.args.initialScrollTop || this.memory[key] || this.scrollTopOffset;\n    if (this.scrollViewElement) {\n      this.scrollTo(position);\n    } else {\n      schedule('afterRender', this, this.scrollTo, position);\n    }\n  }\n\n  @cached\n  get scrollViewApi() {\n    return new ScrollViewApi({\n      _scrollComponent: this,\n    });\n  }\n\n  unregisterScrollPositionCallback(scrollPositionCallback) {\n    let index = this._scrollPositionCallbacks.indexOf(scrollPositionCallback);\n    if (index > -1) {\n      this._scrollPositionCallbacks.splice(index, 1);\n    }\n  }\n\n  registerScrollPositionCallback(scrollPositionCallback) {\n    this._scrollPositionCallbacks.push(scrollPositionCallback);\n  }\n\n  notifyScrollPosition(isScrolling, scrollTop, isAtTop, velocityY) {\n    this._scrollPositionCallbacks.forEach((callback) => {\n      callback(isScrolling, scrollTop, isAtTop, velocityY);\n    });\n  }\n\n  _waiterToken;\n  _trackIsScrollingForWaiter(isScrolling) {\n    if (isScrolling && !this._waiterToken) {\n      this._waiterToken = waiter.beginAsync();\n    } else if (!isScrolling && this._waiterToken) {\n      waiter.endAsync(this._waiterToken);\n      this._waiterToken = undefined;\n    }\n    this._lastIsScrolling = isScrolling;\n  }\n\n  _isScrollingForWaiter() {\n    return !this._lastIsScrolling;\n  }\n\n  _beginMeasurementWaiter() {\n    if (!this._measurementWaiterToken) {\n      this._measurementWaiterToken = measurementWaiter.beginAsync();\n    }\n  }\n\n  _endMeasurementWaiter() {\n    if (this._measurementWaiterToken) {\n      measurementWaiter.endAsync(this._measurementWaiterToken);\n      this._measurementWaiterToken = null;\n    }\n  }\n}\n\nexport default ScrollView;\n"],"names":["waiter","buildWaiter","measurementWaiter","FIELD_REGEXP","MEASUREMENT_INTERVAL","MEASUREMENT_INTERVAL_WHILE_SCROLLING_OR_OFFSCREEN","LONG_PRESS_DELAY","GHOST_CLICK_DELAY","isIPhone","test","navigator","appVersion","timeoutID","addCaptureClick","domElement","clearTimeout","addEventListener","captureClick","cancelCaptureClick","removeEventListener","setTimeout","debounce","func","wait","immediate","timeout","context","args","arguments","later","apply","getScrolledToTopChanged","currentTop","lastTop","offset","isAtTop","isAtTopChanged","undefined","e","stopPropagation","target","closest","ScrollView","Component","_scrollTop","_isAtTop","_needsContentSizeUpdate","_appliedClientWidth","_appliedClientHeight","_appliedContentHeight","g","prototype","tracked","i","void 0","_appliedScrollTop","_shouldMeasureContent","_isScrolling","_touchStartTimeStamp","_lastIsScrolling","_touchStartDecelerationVelocityY","_touchStartWasDecelerating","_touchStartWasDragging","_preventClickWhileDecelerating","_measurementWaiterToken","service","constructor","_scrollPositionCallbacks","debouncedOnScrollingComplete","onScrollingComplete","onContentHeightChanged","contentHeight","measureClientAndContent","n","action","didInsert","element","scrollViewElement","contentElement","firstElementChild","setupScroller","measurementTask","perform","bindScrollerEvents","onKeyUpdated","_lastKey","key","remember","restore","willDestroy","unbindScrollerEvents","isTesting","window","SIMULATE_SCROLL_VIEW_MEASUREMENT_LOOP","_trackIsScrollingForWaiter","scroller","Scroller","onScrollChange","bind","scrollingX","scrollingComplete","_left","top","scrollTop","isDestroyed","isDestroying","isScrolling","__isDragging","__isDecelerating","__isAnimating","_decelerationVelocityY","__decelerationVelocityY","applyScrollTop","decelerationVelocityY","Date","_lastMeasurement","scrollTopOffset","translate","notifyScrollPosition","scrollChange","scrolledToTopChange","updateScrollerDimensions","setDimensions","hammer","Hammer","Manager","inputClass","TouchMouseInput","recognizers","ZyngaScrollerVerticalRecognizer","scrollComponent","_boundHandleWheel","handleWheel","normalizeWheel","getEventType","passive","_scrollViewDocument","ownerDocument","_boundHandleCapturedClick","event","contains","handleCapturedClickDuringMomentum","destroy","doTouchStart","touches","timeStamp","_wasScrollingAtTouchStart","doTouchMove","scale","doTouchEnd","_touches","touchDuration","preventClick","needsPreventClick","MouseEvent","preventDefault","momentumVelocity","isFinishingDragging","wasAnimatingWithMomentum","Math","abs","isLongPress","tagName","match","eventInfo","delta","pixelY","__scrollTop","maxScrollTop","__maxScrollTop","candidatePosition","scrollBy","shouldBlockMomentumClick","stopImmediatePropagation","_buildTask","generator","initialScrollTop","_initialSizeCheckCompleted","scrollTo","lastIsInViewport","isInViewport","_beginMeasurementWaiter","clientWidth","clientHeight","getCurrentClientAndContentSizes","hasClientOrContentSizeChanged","join","applyNewMeasurements","_endMeasurementWaiter","offsetWidth","offsetHeight","isLoadingMore","style","minHeight","updateScrollBarDimensionsTask","clientSizeChange","waitForQueue","scrollBarClientHeight","scrollBarContentHeight","extraCssClasses","windowRef","rect","getBoundingClientRect","left","bottom","innerHeight","document","documentElement","right","innerWidth","yPos","animated","scrollToTop","scrollToTopIfInViewport","scrollToBottom","scrollToElement","el","_yOffset","console","warn","offsetTop","offsetParent","getViewHeight","position","memory","schedule","scrollViewApi","ScrollViewApi","_scrollComponent","cached","unregisterScrollPositionCallback","scrollPositionCallback","index","indexOf","splice","registerScrollPositionCallback","push","velocityY","forEach","callback","_waiterToken","beginAsync","endAsync","_isScrollingForWaiter","setComponentTemplate","TEMPLATE"],"mappings":"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"}